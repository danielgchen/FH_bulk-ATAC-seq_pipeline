ATAC_D0_repl_2_HDACi_S37_trimmed_Aligned.sortedByCoord.out <- c(1.0,0.8232173809096887,0.6574024266331958,0.5363696132926902,0.428859601936525,0.3638306138306138,0.3166577012730859,0.28420297651066884,0.24385870539716695,0.2095511326280557,0.18347677963062578,0.16582989659912736,0.16207937361783514,0.15058872751180444,0.13377861454784531,0.11923973462435,0.10335604566373797,0.09201482278405355,0.08221265913573605,0.08140577371346602,0.07722192337576952,0.07226107226107226,0.06462554539477616,0.05479349710118941,0.04899587591895284,0.046276373199450126,0.04201781124858048,0.04031438646823262,0.03696730619807543,0.035398362321439246,0.03698224852071006,0.03451676528599606,0.03238001314924392,0.03254437869822485,0.03178232024385871,0.030198434044587892,0.028973163588548203,0.023414619568465724,0.02504333273564043,0.022772099695176618,0.017736536967306198,0.014792899408284023,0.010250433327356404,0.008382642998027613,0.007007949315641623,0.003780407626561473,0.0047217739525431835,0.005543601697447852,0.0036010997549459087,0.0038551192397346242,0.003705696013388321,0.0018677903293287908,0.0014942322634630327,0.0030781184627338472,0.004841312533620226,0.0036010997549459087,0.005140158986312832,0.00500567808260116,0.004079254079254079,0.00321259936644552,0.0035413304644073876,0.00457235072619688,0.002973522204291435,0.001509174586097663,0.0013448090371167294,0.0036010997549459087,0.0041390233697926005,0.004706831629908553,0.004632120016735401,0.003063176140099217,0.0030930607853684776,0.003885003885003885,0.004183850337696492,0.006798756798756799,0.008024027254796486,0.008801028031797263,0.009353893969278585,0.008845854999701154,0.004557408403562249,0.004228677305600383,0.00321259936644552,0.0031229454306377384,0.0,0.0002839041300579762,0.0006275775506544738,0.0020470982009443547,0.004617177694100771,0.008053911900065746,0.009712509712509712,0.010071125455740841,0.009667682744605822,0.01001135616520232,0.007665411511565357,0.004617177694100771,0.004213734982965752,0.0015689438766361844,0.003003406849560696,0.0053792361484669175,0.002570079493156416,0.003376964915426454)
ATAC_D8_repl_2_no_tx_S42_trimmed_Aligned.sortedByCoord.out <- c(1.0,0.8355250823579827,0.6694967458553178,0.5481961593057825,0.4385194311273,0.38148485416610867,0.334159145083965,0.3003187186972708,0.25757291694565715,0.2229022149610306,0.19610573961485925,0.18185713903098802,0.17354099150976243,0.1606851112837132,0.13891046415084232,0.12928194552320754,0.1117390256314112,0.09644588477917347,0.0887189651016418,0.08772799100088384,0.08286686129040897,0.0805501245413397,0.07373382971315318,0.06399817875030131,0.05982001767683531,0.05728901625733187,0.05465088250261135,0.04930765728365964,0.045785681763398235,0.04289310871253716,0.04396443206470793,0.041045075930042585,0.03710796261081501,0.03592950692342716,0.03539384524734178,0.03365294480006428,0.03370651096767282,0.0241047754238423,0.026836649971877763,0.022578139646998955,0.017167956718536572,0.016297506494897824,0.012253260840453169,0.011610466829150708,0.011141762862575996,0.009052682325842998,0.007673353509923132,0.007137691833837748,0.008088491308889306,0.007499263465195383,0.006093151565471249,0.002075688994830865,0.003696065564989153,0.006441331654926748,0.010110614136111631,0.008932158448723786,0.010324878806545786,0.010820365856924766,0.008182232102204248,0.007472480381391113,0.006856469453892921,0.009655301711439055,0.005852103811232826,0.005544098347483729,0.005570881431287998,0.0076331788842167285,0.008838417655408843,0.013525457321155957,0.010954281275946113,0.008570586817366152,0.008490237565953344,0.009882957923775344,0.012266652382355305,0.013137102605994055,0.011985430002410478,0.012936229477462036,0.012387176259474516,0.01155690066154217,0.008168840560302114,0.006642204783458767,0.004566515788627903,0.004620081956236441,0.0022631705814607495,0.0026381337547205187,0.0028523984251546722,0.003521975520261403,0.004486166537215095,0.007820660470846614,0.010525751935077805,0.011543509119640036,0.012494308594691592,0.01086054048263117,0.007030559498620671,0.003200578514610172,0.0028390068832525378,0.0,0.00223638749765648,0.0030264884698824224,0.0008168840560302113,0.0023970860004820954)
ATAC_D0_repl_2_no_tx_S39_trimmed_Aligned.sortedByCoord.out <- c(1.0,0.8295844510047804,0.6750385877628089,0.5589905740959974,0.4490416747838336,0.38280559260313796,0.32801846218399244,0.29710329532001617,0.25267117231871244,0.21708051730080472,0.1853561313332634,0.17062534654058834,0.16338733122536753,0.15481560294315985,0.1357090407756515,0.1221621135604142,0.10642729765776027,0.09460370742233744,0.08652650192564175,0.08459336740045856,0.07910866014296204,0.07549714525482909,0.06599631355741709,0.055866089223898935,0.049422307473288275,0.046560069532900754,0.04498658794263536,0.04231916200866164,0.03965173607468793,0.03596529349178043,0.03800332678964799,0.03596529349178043,0.032533605071106385,0.03322293986303217,0.029671367130718856,0.028547451709100717,0.027153796586294226,0.021384364088654448,0.022867932445190392,0.0200656366606225,0.016588991623083724,0.014760755870584886,0.011254139755136294,0.011059327748722482,0.007777494717597518,0.004750415848705999,0.0044207339916980115,0.0038362979724565795,0.006338882977926301,0.004375777374833286,0.003266847492170056,0.0,0.0017832791356341131,0.0034316884206740494,0.004705459231841273,0.004210936446329292,0.00705818884776191,0.006383839594791027,0.003851283511411488,0.004570589381247096,0.00443571953065292,0.00534983740690234,0.0020979754536871917,0.002577512700244264,0.0028472524014326174,0.005304880790037614,0.005424765101676882,0.006578651601204837,0.00624896974419685,0.004705459231841273,0.005469721718541608,0.003986153362005664,0.004600560459156914,0.006803434685528465,0.0076126537890935245,0.008376916275793858,0.007327928548950263,0.006039172198828131,0.0015285249734006683,0.0040760665957351155,0.0030720354857562454,0.003356760725899507,0.0010789588047534129,0.002337744076965728,0.0014535972786261257,0.002127946531597009,0.0021579176095068257,0.003821312433501671,0.008197089808334957,0.008137147652515322,0.00878152582757639,0.007163087620446269,0.0034466739596289583,0.0024126717717402706,0.0031919197973955134,0.001543510512355577,0.00017982646745890216,0.0027873102456129834,0.002247830843236277,0.0010939443437083215)
ATAC_D0_repl_2_LSD1i_S38_trimmed_Aligned.sortedByCoord.out <- c(1.0,0.8288628636191916,0.6672108586540019,0.5454827567596741,0.4408899562847428,0.37932430244481624,0.32384370446327376,0.2905715365103351,0.2463030924496735,0.2146769928220627,0.18738194182092935,0.17321496033245184,0.16714339683739005,0.15234227427276162,0.13813481569431701,0.1251281774515624,0.10704841059960063,0.09548545523233849,0.08768686923201469,0.0865804954395812,0.08268120243941929,0.07696044039073884,0.06914836202709267,0.05742349829996222,0.05194559879108425,0.0486264774137838,0.04546926439635166,0.04308111608829403,0.03821037292892223,0.03645636569701549,0.03620001079389066,0.03533649954125965,0.03193642398402504,0.033676938852609424,0.03083005019159156,0.030371309838631334,0.02873873387662583,0.020643315883210105,0.024434669976793135,0.022707647471531114,0.017985320308705272,0.015637649090614714,0.011347077554104378,0.009579577958875277,0.008257326353284042,0.0058152085919369635,0.006314426034864267,0.006692212207890334,0.005477899508877975,0.006327918398186626,0.005221544605753144,0.0025095795779588753,0.0010793890657887636,0.0027929192077284257,0.0036969075503265154,0.00445247989637865,0.006557288574666738,0.005855685681904042,0.004290571536510335,0.004573911166279886,0.005653300232068649,0.005653300232068649,0.003022289384208538,0.0020238544983539318,0.002577041394570673,0.004290571536510335,0.0037778617302606727,0.0061120405850288734,0.004398510443089212,0.0028603810243402234,0.003642938097037077,0.004128663176642021,0.005208052242430784,0.00797398672351449,0.006408872578120783,0.0072319067407847154,0.00979545577203303,0.007933509633547412,0.003737384640293594,0.003454045010524043,0.00415564790328674,0.0038453235468724704,0.0,0.0010524043391440445,0.001241297425657078,0.0030897512008203356,0.002131793404932808,0.004978682065950672,0.007056506017594041,0.00798747908683685,0.010443089211506287,0.007920017270225052,0.0064358573047655025,0.0042231097198985375,0.004250094446543257,0.0014032057855253926,0.002158778131577527,0.004425495169733931,0.003980247180096066,0.00415564790328674)
ATAC_D8_repl_2_HDACi_S40_trimmed_Aligned.sortedByCoord.out <- c(1.0,0.8368203732324514,0.6734792738345137,0.5551659707965214,0.4545223870268275,0.39929874743373855,0.3507185532052317,0.31348757814121936,0.27090493875573807,0.2399713962769025,0.21205969873820674,0.19358261631796267,0.18281008511914373,0.16770086041844479,0.15266083827362692,0.14048118843855967,0.125671841480012,0.11745980484879241,0.10479573712255773,0.09840603446287283,0.09330811284630113,0.08904062190030218,0.08435791561901686,0.07446195012802473,0.06698807409286983,0.0651196050840811,0.062835920740006,0.05884524001753132,0.05792253927245046,0.05374731840095961,0.05197111946667897,0.05208645705981407,0.046642522663837054,0.04615810477266961,0.04359761020507024,0.04078337293257364,0.04099098060021684,0.03273280893174321,0.034555142903277894,0.03296348411801343,0.029388018730825125,0.02666605153283661,0.02339046388779959,0.02142972480450278,0.020622361652557035,0.016539410855574265,0.01893843279278448,0.01677008604184448,0.017254503933011926,0.017969597010449586,0.015939655371271712,0.014578671772277457,0.011718299462526815,0.015478304998731287,0.016377938225185115,0.016677815967336394,0.0178773269359415,0.016562478374201287,0.01266406772623469,0.01393278125072086,0.014186523955618095,0.015339899886969158,0.013609835989942563,0.013609835989942563,0.01231805494682937,0.01194897464879703,0.014186523955618095,0.01713916633987682,0.014947752070309796,0.014855481995801712,0.01231805494682937,0.010472653456667666,0.01464787432815852,0.01718530137713086,0.016585545892828308,0.019192175497681714,0.017992664529076607,0.016493275818320222,0.012064312241932135,0.009711425341975964,0.00802749648220341,0.007173998293003621,0.004567368688150216,0.0032755876450370233,0.0036446679430693642,0.007312403404765749,0.00908860233904639,0.011879772092915965,0.013863578694839796,0.015040022144817882,0.012456460058591497,0.010149708195889368,0.010172775714516389,0.0032986551636640447,0.003091047496020853,0.003621600424442343,0.0018223339715346821,0.0014763211921293626,0.0,0.0012225784872321285)
ATAC_D8_repl_2_LSD1i_S41_trimmed_Aligned.sortedByCoord.out <- c(1.0,0.8552315608919383,0.6897727272727273,0.5793953687821612,0.47439965694682673,0.42058319039451114,0.3680746140651801,0.3338336192109777,0.28756432246998287,0.25370926243567754,0.21974699828473412,0.20274442538593482,0.19011578044596913,0.17317753001715266,0.1553173241852487,0.13936535162950256,0.12489279588336193,0.11438679245283019,0.10484562607204116,0.1,0.09948542024013722,0.09451114922813036,0.08760720411663808,0.07722984562607205,0.07360634648370497,0.06601629502572899,0.06352915951972556,0.05705403087478559,0.053430531732418525,0.04912092624356775,0.05180102915951972,0.05197255574614065,0.04614065180102916,0.04588336192109777,0.040523156089193824,0.040737564322469985,0.04022298456260721,0.0338336192109777,0.03481989708404803,0.033940823327615784,0.026436535162950258,0.02759433962264151,0.023992281303602057,0.02180531732418525,0.019789879931389365,0.017324185248713552,0.014965694682675815,0.015608919382504288,0.014150943396226415,0.011213550600343054,0.01153516295025729,0.01061320754716981,0.008340480274442539,0.007761578044596913,0.011106346483704975,0.01123499142367067,0.011578044596912522,0.012392795883361922,0.00960548885077187,0.0104631217838765,0.014686963979416809,0.012671526586620926,0.009927101200686106,0.00823327615780446,0.0075900514579759866,0.010827615780445969,0.012371355060034304,0.0120926243567753,0.011192109777015437,0.009648370497427101,0.011556603773584905,0.012414236706689537,0.012671526586620926,0.013829331046312178,0.01584476843910806,0.019596912521440822,0.016037735849056604,0.014365351629502573,0.007911663807890223,0.006903945111492281,0.0033447684391080617,0.00630360205831904,0.004781303602058319,0.005188679245283019,0.005253001715265866,0.003945111492281304,0.004995711835334477,0.007246998284734134,0.008812178387650086,0.01042024013722127,0.0129073756432247,0.010506003430531732,0.008876500857632932,0.0023799313893653517,0.0,0.0010506003430531732,0.00036449399656946825,0.0006861063464837049,0.000493138936535163,0.00032161234991423673)
data_matrix <- matrix(c(ATAC_D0_repl_2_HDACi_S37_trimmed_Aligned.sortedByCoord.out,ATAC_D8_repl_2_no_tx_S42_trimmed_Aligned.sortedByCoord.out,ATAC_D0_repl_2_no_tx_S39_trimmed_Aligned.sortedByCoord.out,ATAC_D0_repl_2_LSD1i_S38_trimmed_Aligned.sortedByCoord.out,ATAC_D8_repl_2_HDACi_S40_trimmed_Aligned.sortedByCoord.out,ATAC_D8_repl_2_LSD1i_S41_trimmed_Aligned.sortedByCoord.out), byrow=T, ncol=100)
rowLabel <- c("ATAC_D0_repl_2_HDACi_S37_trimmed_Aligned.sortedByCoord.out","ATAC_D8_repl_2_no_tx_S42_trimmed_Aligned.sortedByCoord.out","ATAC_D0_repl_2_no_tx_S39_trimmed_Aligned.sortedByCoord.out","ATAC_D0_repl_2_LSD1i_S38_trimmed_Aligned.sortedByCoord.out","ATAC_D8_repl_2_HDACi_S40_trimmed_Aligned.sortedByCoord.out","ATAC_D8_repl_2_LSD1i_S41_trimmed_Aligned.sortedByCoord.out")


pdf("qc_reports/mapping_reads/rseqc.geneBodyCoverage.heatMap.pdf")
rc <- cm.colors(ncol(data_matrix))
heatmap(data_matrix, scale=c("none"),keep.dendro=F, labRow = rowLabel ,Colv = NA,Rowv = NA,labCol=NA,col=cm.colors(256),margins = c(6, 8),ColSideColors = rc,cexRow=1,cexCol=1,xlab="Gene body percentile (5'->3')", add.expr=x_axis_expr <- axis(side=1,at=c(1,10,20,30,40,50,60,70,80,90,100),labels=c("1","10","20","30","40","50","60","70","80","90","100")))
dev.off()


pdf("qc_reports/mapping_reads/rseqc.geneBodyCoverage.curves.pdf")
x=1:100
icolor = colorRampPalette(c("#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"))(6)
plot(x,ATAC_D0_repl_2_HDACi_S37_trimmed_Aligned.sortedByCoord.out,type='l',xlab="Gene body percentile (5'->3')", ylab="Coverage",lwd=0.8,col=icolor[1])
lines(x,ATAC_D8_repl_2_no_tx_S42_trimmed_Aligned.sortedByCoord.out,type='l',col=icolor[2])
lines(x,ATAC_D0_repl_2_no_tx_S39_trimmed_Aligned.sortedByCoord.out,type='l',col=icolor[3])
lines(x,ATAC_D0_repl_2_LSD1i_S38_trimmed_Aligned.sortedByCoord.out,type='l',col=icolor[4])
lines(x,ATAC_D8_repl_2_HDACi_S40_trimmed_Aligned.sortedByCoord.out,type='l',col=icolor[5])
lines(x,ATAC_D8_repl_2_LSD1i_S41_trimmed_Aligned.sortedByCoord.out,type='l',col=icolor[6])
legend(0,1,fill=icolor[1:6], legend=c('ATAC_D0_repl_2_HDACi_S37_trimmed_Aligned.sortedByCoord.out','ATAC_D8_repl_2_no_tx_S42_trimmed_Aligned.sortedByCoord.out','ATAC_D0_repl_2_no_tx_S39_trimmed_Aligned.sortedByCoord.out','ATAC_D0_repl_2_LSD1i_S38_trimmed_Aligned.sortedByCoord.out','ATAC_D8_repl_2_HDACi_S40_trimmed_Aligned.sortedByCoord.out','ATAC_D8_repl_2_LSD1i_S41_trimmed_Aligned.sortedByCoord.out'))
dev.off()
